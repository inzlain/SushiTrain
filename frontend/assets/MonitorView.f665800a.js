import{D as v}from"./datetime.ba57e231.js";import{e as g,f,o as s,g as q,h as l,T as w,c as o,a as e,F as _,i as y,d as u,b as d,t as i,j as a,k as p}from"./index.1e99d4f4.js";import{_ as k}from"./_plugin-vue_export-helper.cdc0426e.js";const b={computed:{DateTime(){return v}},data(){return{allowed_requests:[],denied_requests:[],isLoading:!0}},methods:{getMonitor(){fetch("/api/monitor").then(n=>n.json()).then(n=>{this.allowed_requests=n.allowed_requests,this.denied_requests=n.denied_requests,this.isLoading=!1})}},created(){this.getMonitor(),this.timer=setInterval(this.getMonitor,5e3)},unmounted(){clearInterval(this.timer)}},D={key:0},x={class:"tile is-ancestor"},T={class:"tile is-parent is-12"},I={class:"tile is-child is-12"},M={class:"message is-success"},R=e("div",{class:"message-header"},"Recent Allowed Requests",-1),V={class:"message-body"},L={class:"table is-fullwidth is-hoverable has-background-success-light"},A=e("thead",null,[e("tr",null,[e("th",{style:{width:"15%"}},"When"),e("th",{style:{width:"20%"}},"Hostname"),e("th",{style:{width:"20%"}},"Path"),e("th",{style:{width:"15%"}},"IP Address"),e("th",{style:{width:"25%"}},"User Agent"),e("th",{style:{width:"5%"}},"Details")])],-1),S={key:0,class:"is-truncated"},B={key:1,class:"is-truncated has-text-danger"},F={class:"is-truncated"},N={class:"is-truncated"},O={class:"has-text-centered"},P=e("span",{class:"icon"},[e("i",{class:"fas fa-circle-info"})],-1),C=e("span",null,"View",-1),j={class:"tile is-ancestor"},H={class:"tile is-parent is-12"},U={class:"tile is-child is-12"},W={class:"message is-danger"},E=e("div",{class:"message-header"},"Recent Denied Requests",-1),z={class:"message-body"},G={class:"table is-fullwidth is-hoverable has-background-danger-light"},J=e("thead",null,[e("tr",null,[e("th",{style:{width:"15%"}},"When"),e("th",{style:{width:"20%"}},"Hostname"),e("th",{style:{width:"20%"}},"Path"),e("th",{style:{width:"15%"}},"IP Address"),e("th",{style:{width:"25%"}},"User Agent"),e("th",{style:{width:"5%"}},"Details")])],-1),K={key:0,class:"is-truncated"},Q={key:1,class:"is-truncated has-text-danger"},X={class:"is-truncated"},Y={class:"is-truncated"},Z={class:"has-text-centered"},$=e("span",{class:"icon"},[e("i",{class:"fas fa-circle-info"})],-1),ee=e("span",null,"View",-1);function te(n,se,oe,ie,h,c){const m=g("RouterLink"),r=f("tooltip");return s(),q(w,null,{default:l(()=>[h.isLoading===!1?(s(),o("div",D,[e("div",x,[e("div",T,[e("div",I,[e("article",M,[R,e("div",V,[e("table",L,[A,e("tbody",null,[(s(!0),o(_,null,y(h.allowed_requests,t=>d((s(),o("tr",{key:t.id},[e("td",null,i(c.DateTime.fromISO(t.datetime).toRelative()),1),t.redirector_hostname?d((s(),o("td",S,[a(i(t.redirector_hostname),1)])),[[r,t.redirector_hostname,void 0,{top:!0}]]):d((s(),o("td",B,[a(i(t.request_hostname),1)])),[[r,t.redirector_hostname,void 0,{top:!0}]]),d((s(),o("td",F,[a(i(t.redirector_path),1)])),[[r,t.redirector_path,void 0,{top:!0}]]),d((s(),o("td",null,[a(i(t.request_ip)+" ",1),t.request_country_code?(s(),o(_,{key:0},[a("("+i(t.request_country_code)+")",1)],64)):u("",!0)])),[[r,t.request_asn_org_name,void 0,{top:!0}]]),d((s(),o("td",N,[a(i(t.request_user_agent),1)])),[[r,t.request_user_agent,void 0,{top:!0}]]),e("td",O,[p(m,{class:"button is-link is-outlined",to:{name:"request-log",params:{id:t.id}}},{default:l(()=>[P,C]),_:2},1032,["to"])])])),[[r,c.DateTime.fromISO(t.datetime).toFormat("yyyy-MM-dd hh:mm:ss"),void 0,{left:!0}]])),128))])])])])])])]),e("div",j,[e("div",H,[e("div",U,[e("article",W,[E,e("div",z,[e("table",G,[J,e("tbody",null,[(s(!0),o(_,null,y(h.denied_requests,t=>d((s(),o("tr",{key:t.id},[e("td",null,i(c.DateTime.fromISO(t.datetime).toRelative()),1),t.redirector_hostname?d((s(),o("td",K,[a(i(t.redirector_hostname),1)])),[[r,t.redirector_hostname,void 0,{top:!0}]]):d((s(),o("td",Q,[a(i(t.request_hostname),1)])),[[r,t.redirector_hostname,void 0,{top:!0}]]),d((s(),o("td",X,[a(i(t.redirector_path),1)])),[[r,t.redirector_path,void 0,{top:!0}]]),d((s(),o("td",null,[a(i(t.request_ip)+" ",1),t.request_country_code?(s(),o(_,{key:0},[a("("+i(t.request_country_code)+")",1)],64)):u("",!0)])),[[r,t.request_asn_org_name,void 0,{top:!0}]]),d((s(),o("td",Y,[a(i(t.request_user_agent),1)])),[[r,t.request_user_agent,void 0,{top:!0}]]),e("td",Z,[p(m,{class:"button is-link is-outlined",to:{name:"request-log",params:{id:t.id}}},{default:l(()=>[$,ee]),_:2},1032,["to"])])])),[[r,c.DateTime.fromISO(t.datetime).toFormat("yyyy-MM-dd hh:mm:ss"),void 0,{left:!0}]])),128))])])])])])])])])):u("",!0)]),_:1})}const ne=k(b,[["render",te]]);export{ne as default};

import{r,e as p,o as a,g as u,h as d,T as m,c,a as s,t as v,d as h,b as o,v as n,k as b}from"./index.1e99d4f4.js";import{_ as k}from"./_plugin-vue_export-helper.cdc0426e.js";const w={data(){return{name:"",notes:"",geographic_blocklist:"",geographic_allowlist:"",ip_range_blocklist:"",ip_range_allowlist:"",user_agent_allowlist:"",user_agent_blocklist:"",asn_allowlist:"",asn_blocklist:"",isLoading:!0,error:""}},methods:{getPolicy(){this.$route.params.id>0?fetch("/api/policies/"+this.$route.params.id).then(l=>l.json()).then(l=>{this.name=l.name,this.notes=l.notes,this.geographic_blocklist=l.geographic_blocklist,this.geographic_allowlist=l.geographic_allowlist,this.ip_range_blocklist=l.ip_range_blocklist,this.ip_range_allowlist=l.ip_range_allowlist,this.user_agent_allowlist=l.user_agent_allowlist,this.user_agent_blocklist=l.user_agent_blocklist,this.asn_allowlist=l.asn_allowlist,this.asn_blocklist=l.asn_blocklist,this.isLoading=!1}):this.isLoading=!1},addPolicy(){const l=JSON.stringify({name:this.name,notes:this.notes,geographic_blocklist:this.geographic_blocklist,geographic_allowlist:this.geographic_allowlist,ip_range_blocklist:this.ip_range_blocklist,ip_range_allowlist:this.ip_range_allowlist,user_agent_allowlist:this.user_agent_allowlist,user_agent_blocklist:this.user_agent_blocklist,asn_allowlist:this.asn_allowlist,asn_blocklist:this.asn_blocklist});fetch("/api/policies",{method:"POST",body:l}).then(e=>e.json()).then(e=>{e.created===!0?r.push("/policies"):(this.error=e.error,window.scrollTo(0,0))})},editPolicy(){const l=JSON.stringify({name:this.name,notes:this.notes,geographic_blocklist:this.geographic_blocklist,geographic_allowlist:this.geographic_allowlist,ip_range_blocklist:this.ip_range_blocklist,ip_range_allowlist:this.ip_range_allowlist,user_agent_allowlist:this.user_agent_allowlist,user_agent_blocklist:this.user_agent_blocklist,asn_allowlist:this.asn_allowlist,asn_blocklist:this.asn_blocklist});fetch("/api/policies/"+this.$route.params.id,{method:"PUT",body:l}).then(e=>e.json()).then(e=>{e.modified===!0?r.push("/policies"):(this.error=e.error,window.scrollTo(0,0))})}},created(){this.getPolicy()}},f={key:0},y={key:0,class:"message is-danger"},x=s("div",{class:"message-header"},[s("p",null,"Error")],-1),P={class:"message-body"},C={class:"box"},A={key:0,class:"title"},U={key:1,class:"title"},V={class:"tile is-ancestor"},B={class:"tile is-parent is-6"},O={class:"tile is-child"},N={class:"field"},S=s("label",{class:"label"},"Name",-1),T={class:"control"},I={class:"tile is-parent is-6"},L={class:"tile is-child"},R={class:"field"},E=s("label",{class:"label"},"Notes",-1),j={class:"control"},z={class:"tile is-ancestor"},D={class:"tile is-parent is-6"},G={class:"tile is-child is-12"},M={class:"message is-danger"},W=s("div",{class:"message-header"},"Geographic Blocklist",-1),J={class:"message-body"},K=s("p",null,"Block access to countries:",-1),q=s("br",null,null,-1),F={class:"field"},H=s("p",null,"(Two letter country codes, one per line)",-1),X={class:"tile is-parent is-6"},Q={class:"tile is-child is-12"},Y={class:"message is-success"},Z=s("div",{class:"message-header"},"Geographic Allowlist",-1),$={class:"message-body"},ss=s("p",null,"Only allow access to countries:",-1),es=s("br",null,null,-1),is={class:"field"},ts=s("p",null,"(Two letter country codes, one per line)",-1),ls={class:"tile is-ancestor"},os={class:"tile is-parent is-6"},ns={class:"tile is-child is-12"},as={class:"message is-danger"},cs=s("div",{class:"message-header"},"IP Range Blocklist",-1),_s={class:"message-body"},rs=s("p",null,"Block access to IP ranges:",-1),ds=s("br",null,null,-1),hs={class:"field"},gs=s("p",null,"(IP ranges in CIDR notation, one per line)",-1),ps={class:"tile is-parent is-6"},us={class:"tile is-child is-12"},ms={class:"message is-success"},vs=s("div",{class:"message-header"},"IP Range Allowlist",-1),bs={class:"message-body"},ks=s("p",null,"Only allow access to IP ranges:",-1),ws=s("br",null,null,-1),fs={class:"field"},ys=s("p",null,"(IP ranges in CIDR notation, one per line)",-1),xs={class:"tile is-ancestor"},Ps={class:"tile is-parent is-6"},Cs={class:"tile is-child is-12"},As={class:"message is-danger"},Us=s("div",{class:"message-header"},"ASN Organization Blocklist",-1),Vs={class:"message-body"},Bs=s("p",null,"Block access to ASN Organizations:",-1),Os=s("br",null,null,-1),Ns={class:"field"},Ss=s("p",null,"(Case insensitive strings to match against, one per line)",-1),Ts={class:"tile is-parent is-6"},Is={class:"tile is-child is-12"},Ls={class:"message is-success"},Rs=s("div",{class:"message-header"},"ASN Organization Allowlist",-1),Es={class:"message-body"},js=s("p",null,"Only allow access to ASN Organizations:",-1),zs=s("br",null,null,-1),Ds={class:"field"},Gs=s("p",null,"(Case insensitive strings to match against, one per line)",-1),Ms={class:"tile is-ancestor"},Ws={class:"tile is-parent is-6"},Js={class:"tile is-child is-12"},Ks={class:"message is-danger"},qs=s("div",{class:"message-header"},"User Agent Blocklist",-1),Fs={class:"message-body"},Hs=s("p",null,"Block access to user agents:",-1),Xs=s("br",null,null,-1),Qs={class:"field"},Ys=s("p",null,"(Case insensitive strings to match against, one per line)",-1),Zs={class:"tile is-parent is-6"},$s={class:"tile is-child is-12"},se={class:"message is-success"},ee=s("div",{class:"message-header"},"User Agent Allowlist",-1),ie={class:"message-body"},te=s("p",null,"Only allow access to user agents:",-1),le=s("br",null,null,-1),oe={class:"field"},ne=s("p",null,"(Case insensitive strings to match against, one per line)",-1),ae={class:"field is-grouped"},ce={class:"control"},_e=s("span",{class:"icon"},[s("i",{class:"fas fa-circle-check"})],-1),re=s("span",null,"Save",-1),de=[_e,re],he=s("span",{class:"icon"},[s("i",{class:"fas fa-circle-check"})],-1),ge=s("span",null,"Save",-1),pe=[he,ge],ue={class:"control"},me=s("span",{class:"icon"},[s("i",{class:"fas fa-circle-xmark"})],-1),ve=s("span",null,"Cancel",-1);function be(l,e,ke,we,i,_){const g=p("RouterLink");return a(),u(m,null,{default:d(()=>[i.isLoading===!1?(a(),c("div",f,[i.error?(a(),c("article",y,[x,s("div",P,v(i.error),1)])):h("",!0),s("div",C,[l.$route.params.id?(a(),c("h1",A,"Edit Policy")):(a(),c("h1",U,"Add Policy")),s("div",V,[s("div",B,[s("div",O,[s("div",N,[S,s("div",T,[o(s("input",{class:"input",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>i.name=t),placeholder:"Office Only",required:""},null,512),[[n,i.name]])])])])]),s("div",I,[s("div",L,[s("div",R,[E,s("div",j,[o(s("input",{class:"input",type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>i.notes=t),placeholder:"Restricts access to Chrome users from the Los Angeles office"},null,512),[[n,i.notes]])])])])])]),s("div",z,[s("div",D,[s("div",G,[s("article",M,[W,s("div",J,[K,q,s("div",F,[o(s("textarea",{class:"textarea","onUpdate:modelValue":e[2]||(e[2]=t=>i.geographic_blocklist=t),placeholder:`US
CA
MX`,rows:"4"},null,512),[[n,i.geographic_blocklist]])]),H])])])]),s("div",X,[s("div",Q,[s("article",Y,[Z,s("div",$,[ss,es,s("div",is,[o(s("textarea",{class:"textarea","onUpdate:modelValue":e[3]||(e[3]=t=>i.geographic_allowlist=t),placeholder:`DE
FR
GB`,rows:"4"},null,512),[[n,i.geographic_allowlist]])]),ts])])])])]),s("div",ls,[s("div",os,[s("div",ns,[s("article",as,[cs,s("div",_s,[rs,ds,s("div",hs,[o(s("textarea",{class:"textarea","onUpdate:modelValue":e[4]||(e[4]=t=>i.ip_range_blocklist=t),placeholder:`203.0.113.89/32
198.51.100.0/24`,rows:"4"},null,512),[[n,i.ip_range_blocklist]])]),gs])])])]),s("div",ps,[s("div",us,[s("article",ms,[vs,s("div",bs,[ks,ws,s("div",fs,[o(s("textarea",{class:"textarea","onUpdate:modelValue":e[5]||(e[5]=t=>i.ip_range_allowlist=t),placeholder:`233.252.0.0/24
203.0.113.18/32`,rows:"4"},null,512),[[n,i.ip_range_allowlist]])]),ys])])])])]),s("div",xs,[s("div",Ps,[s("div",Cs,[s("article",As,[Us,s("div",Vs,[Bs,Os,s("div",Ns,[o(s("textarea",{class:"textarea","onUpdate:modelValue":e[6]||(e[6]=t=>i.asn_blocklist=t),placeholder:`microsoft
digitalocean`,rows:"4"},null,512),[[n,i.asn_blocklist]])]),Ss])])])]),s("div",Ts,[s("div",Is,[s("article",Ls,[Rs,s("div",Es,[js,zs,s("div",Ds,[o(s("textarea",{class:"textarea","onUpdate:modelValue":e[7]||(e[7]=t=>i.asn_allowlist=t),placeholder:`centurylink
xfinity`,rows:"4"},null,512),[[n,i.asn_allowlist]])]),Gs])])])])]),s("div",Ms,[s("div",Ws,[s("div",Js,[s("article",Ks,[qs,s("div",Fs,[Hs,Xs,s("div",Qs,[o(s("textarea",{class:"textarea","onUpdate:modelValue":e[8]||(e[8]=t=>i.user_agent_blocklist=t),placeholder:`curl
wget`,rows:"4"},null,512),[[n,i.user_agent_blocklist]])]),Ys])])])]),s("div",Zs,[s("div",$s,[s("article",se,[ee,s("div",ie,[te,le,s("div",oe,[o(s("textarea",{class:"textarea","onUpdate:modelValue":e[9]||(e[9]=t=>i.user_agent_allowlist=t),placeholder:`firefox
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.57`,rows:"4"},null,512),[[n,i.user_agent_allowlist]])]),ne])])])])]),s("div",ae,[s("div",ce,[l.$route.params.id?(a(),c("button",{key:0,class:"button is-link",type:"submit",onClick:e[10]||(e[10]=t=>_.editPolicy())},de)):(a(),c("button",{key:1,class:"button is-link",type:"submit",onClick:e[11]||(e[11]=t=>_.addPolicy())},pe))]),s("div",ue,[b(g,{class:"button is-link is-light",to:"/policies"},{default:d(()=>[me,ve]),_:1})])])])])):h("",!0)]),_:1})}const xe=k(w,[["render",be]]);export{xe as default};

import{r as p,e as b,o as l,g as v,h as g,T as x,c as n,a as e,t as f,d as _,b as d,v as a,q as c,j as r,n as y,s as k,F as w,i as V,u as h,k as T}from"./index.9c24e311.js";import{_ as C}from"./_plugin-vue_export-helper.cdc0426e.js";const P={data(){return{policies:[],hostname:"",https:"yes",port:"443",host_header:"",notes:"",headers:"",default_policy_id:null,default_logging:!0,default_logging_request_body:!0,default_logging_response_body:!0,prefer_leftmost_x_forwarded_for:"yes",selected_tab:"policy",isLoading:!0,error:""}},methods:{getRedirector(){this.$route.params.id>0?fetch("/api/redirectors/"+this.$route.params.id).then(i=>i.json()).then(i=>{this.hostname=i.hostname,this.host_header=i.host_header,this.notes=i.notes,this.headers=i.headers,this.port=i.port,this.https=i.https,this.default_policy_id=i.default_policy_id,this.default_logging=i.default_logging,this.default_logging_request_body=i.default_logging_request_body,this.default_logging_response_body=i.default_logging_response_body,this.prefer_leftmost_x_forwarded_for=i.prefer_leftmost_x_forwarded_for,this.isLoading=!1}):this.isLoading=!1},addRedirector(){const i=JSON.stringify({hostname:this.hostname,host_header:this.host_header,notes:this.notes,headers:this.headers,port:this.port,https:this.https,default_policy_id:this.default_policy_id,default_logging:this.default_logging,default_logging_request_body:this.default_logging_request_body,default_logging_response_body:this.default_logging_response_body,prefer_leftmost_x_forwarded_for:this.prefer_leftmost_x_forwarded_for});fetch("/api/redirectors",{method:"POST",body:i}).then(s=>s.json()).then(s=>{s.created===!0?p.push("/redirectors"):(this.error=s.error,window.scrollTo(0,0))})},editRedirector(){const i=JSON.stringify({hostname:this.hostname,host_header:this.host_header,notes:this.notes,headers:this.headers,port:this.port,https:this.https,default_policy_id:this.default_policy_id,default_logging:this.default_logging,default_logging_request_body:this.default_logging_request_body,default_logging_response_body:this.default_logging_response_body,prefer_leftmost_x_forwarded_for:this.prefer_leftmost_x_forwarded_for});fetch("/api/redirectors/"+this.$route.params.id,{method:"PUT",body:i}).then(s=>s.json()).then(s=>{s.modified===!0?p.push("/redirectors"):(this.error=s.error,window.scrollTo(0,0))})},getPolicies(){fetch("/api/policies?list=1").then(i=>i.json()).then(i=>{this.policies=i})}},created(){this.getPolicies(),this.getRedirector()}},L={key:0},U={key:0,class:"message is-danger"},q=e("div",{class:"message-header"},[e("p",null,"Error")],-1),R={class:"message-body"},S={class:"box"},F={key:0,class:"title"},N={key:1,class:"title"},j={class:"tile is-ancestor"},H={class:"tile is-parent is-6"},D={class:"tile is-child"},E={class:"field"},B=e("label",{class:"label"},"Hostname",-1),M={class:"control"},O={class:"tile is-parent is-6"},X={class:"tile is-child"},A={class:"field"},J=e("label",{class:"label"},"Notes",-1),z={class:"control"},I={class:"tile is-ancestor"},Y={class:"tile is-parent is-3"},G={class:"tile is-child"},K={class:"field"},Q=e("label",{class:"label"},"Host Header (i.e. domain fronting)",-1),W={class:"control"},Z={class:"tile is-parent is-1"},$={class:"tile is-child"},ee={class:"field"},se=e("label",{class:"label"},"Port",-1),te={class:"control"},oe={class:"tile is-parent is-2"},ie={class:"tile is-child"},le={class:"field"},ne=e("label",{class:"label"},"Protocol",-1),de={class:"control"},re={class:"radio"},ae={class:"radio"},_e={class:"message is-primary"},ce=e("div",{class:"message-header"},"Headers",-1),he={class:"message-body"},ue=e("p",null,"These headers will be automatically applied to every path under this redirector, as well to 404 responses for non-existent paths that are requested. Each individual path also has it's own headers that can be configured in addition to these redirector-wide headers. Path level headers take precedence over these headers and will overwrite them.",-1),pe=e("br",null,null,-1),ge={class:"field"},fe={class:"message is-primary"},ye=e("div",{class:"message-header"},"X-Forward-For Handling",-1),me={class:"message-body"},be=e("p",null,"You can modify the way Sushi Train handled the X-Forwarded-For header for this redirector. This is useful for redirectors where you have little control over the value of the X-Forwarded-For header.",-1),ve=e("br",null,null,-1),xe={class:"field"},ke=e("label",{class:"label"},"IP Address Position",-1),we={class:"control"},Ve={class:"radio"},Te={class:"radio"},Ce={class:"message is-primary"},Pe=e("div",{class:"message-header"},"Default Path Settings",-1),Le={class:"message-body"},Ue={class:"tabs"},qe={key:0,class:"has-text-primary-dark",style:{"text-decoration":"none"}},Re=e("strong",null,"Policy",-1),Se=[Re],Fe={key:1,class:"has-text-primary",style:{"text-decoration":"none"}},Ne={key:0,class:"has-text-primary-dark",style:{"text-decoration":"none"}},je=e("strong",null,"Logging",-1),He=[je],De={key:1,class:"has-text-primary",style:{"text-decoration":"none"}},Ee={key:0},Be=e("p",null,"This is the default policy that will be applied to newly created paths under this redirector. Changing this setting won't affect the policy setting of any existing paths.",-1),Me=e("br",null,null,-1),Oe={class:"field"},Xe=e("label",{class:"label"},"Select Default Policy",-1),Ae={class:"control"},Je={class:"select"},ze=e("option",{value:"null"},"None",-1),Ie=["value"],Ye={key:1},Ge=e("p",null,"This is the default log retention configuration that will be applied to newly created paths under this redirector. Changing this setting won't affect the log retention configuration of any existing paths.",-1),Ke=e("br",null,null,-1),Qe={class:"field"},We=e("label",{class:"label"},"Default Logging Configuration",-1),Ze={class:"checkbox"},$e=e("br",null,null,-1),es={class:"checkbox"},ss=e("br",null,null,-1),ts={class:"checkbox"},os={class:"field is-grouped"},is={class:"control"},ls=e("span",{class:"icon"},[e("i",{class:"fas fa-circle-check"})],-1),ns=e("span",null,"Save",-1),ds=[ls,ns],rs=e("span",{class:"icon"},[e("i",{class:"fas fa-circle-check"})],-1),as=e("span",null,"Save",-1),_s=[rs,as],cs={class:"control"},hs=e("span",{class:"icon"},[e("i",{class:"fas fa-circle-xmark"})],-1),us=e("span",null,"Cancel",-1);function ps(i,s,gs,fs,t,u){const m=b("RouterLink");return l(),v(x,null,{default:g(()=>[t.isLoading===!1?(l(),n("div",L,[t.error?(l(),n("article",U,[q,e("div",R,f(t.error),1)])):_("",!0),e("div",S,[i.$route.params.id?(l(),n("h1",F,"Edit Redirector")):(l(),n("h1",N,"Add Redirector")),e("div",j,[e("div",H,[e("div",D,[e("div",E,[B,e("div",M,[d(e("input",{class:"input",type:"text","onUpdate:modelValue":s[0]||(s[0]=o=>t.hostname=o),placeholder:"example.com",required:""},null,512),[[a,t.hostname]])])])])]),e("div",O,[e("div",X,[e("div",A,[J,e("div",z,[d(e("input",{class:"input",type:"text","onUpdate:modelValue":s[1]||(s[1]=o=>t.notes=o),placeholder:"Delivery of phishing payloads"},null,512),[[a,t.notes]])])])])])]),e("div",I,[e("div",Y,[e("div",G,[e("div",K,[Q,e("div",W,[d(e("input",{class:"input",type:"text","onUpdate:modelValue":s[2]||(s[2]=o=>t.host_header=o),placeholder:"yourname.cdn.com"},null,512),[[a,t.host_header]])])])])]),e("div",Z,[e("div",$,[e("div",ee,[se,e("div",te,[d(e("input",{class:"input",type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>t.port=o),placeholder:"443"},null,512),[[a,t.port]])])])])]),e("div",oe,[e("div",ie,[e("div",le,[ne,e("div",de,[e("label",re,[d(e("input",{type:"radio",name:"https",value:"yes","onUpdate:modelValue":s[4]||(s[4]=o=>t.https=o)},null,512),[[c,t.https]]),r(" HTTPS ")]),e("label",ae,[d(e("input",{type:"radio",name:"https",value:"no","onUpdate:modelValue":s[5]||(s[5]=o=>t.https=o)},null,512),[[c,t.https]]),r(" HTTP ")])])])])])]),e("article",_e,[ce,e("div",he,[ue,pe,e("div",ge,[d(e("textarea",{class:"textarea","onUpdate:modelValue":s[6]||(s[6]=o=>t.headers=o),placeholder:`Server: nginx
Cache-Control: no-cache`,rows:"4"},null,512),[[a,t.headers]])])])]),e("article",fe,[ye,e("div",me,[be,ve,e("div",xe,[ke,e("div",we,[e("label",Ve,[d(e("input",{type:"radio",name:"prefer_leftmost_x_forwarded_for",value:"yes","onUpdate:modelValue":s[7]||(s[7]=o=>t.prefer_leftmost_x_forwarded_for=o)},null,512),[[c,t.prefer_leftmost_x_forwarded_for]]),r(" Left-most value ")]),e("label",Te,[d(e("input",{type:"radio",name:"prefer_leftmost_x_forwarded_for",value:"no","onUpdate:modelValue":s[8]||(s[8]=o=>t.prefer_leftmost_x_forwarded_for=o)},null,512),[[c,t.prefer_leftmost_x_forwarded_for]]),r(" Right-most value ")])])])])]),e("article",Ce,[Pe,e("div",Le,[e("div",Ue,[e("ul",null,[e("li",{class:y({"is-active":t.selected_tab==="policy"}),onClick:s[9]||(s[9]=o=>t.selected_tab="policy")},[t.selected_tab==="policy"?(l(),n("a",qe,Se)):(l(),n("a",Fe,"Policy"))],2),e("li",{class:y({"is-active":t.selected_tab==="logging"}),onClick:s[10]||(s[10]=o=>t.selected_tab="logging")},[t.selected_tab==="logging"?(l(),n("a",Ne,He)):(l(),n("a",De,"Logging"))],2)])]),t.selected_tab==="policy"?(l(),n("div",Ee,[Be,Me,e("div",Oe,[Xe,e("div",Ae,[e("div",Je,[d(e("select",{class:"is-truncated-select-option","onUpdate:modelValue":s[11]||(s[11]=o=>t.default_policy_id=o)},[ze,(l(!0),n(w,null,V(t.policies,o=>(l(),n("option",{key:o.id,value:o.id},f(o.name),9,Ie))),128))],512),[[k,t.default_policy_id]])])])])])):_("",!0),t.selected_tab==="logging"?(l(),n("div",Ye,[Ge,Ke,e("div",Qe,[We,e("label",Ze,[d(e("input",{type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=o=>t.default_logging=o)},null,512),[[h,t.default_logging]]),r(" Logging enabled ")]),$e,r("\xA0\xA0\xA0\xA0 "),e("label",es,[d(e("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=o=>t.default_logging_request_body=o)},null,512),[[h,t.default_logging_request_body]]),r(" Log request body ")]),ss,r("\xA0\xA0\xA0\xA0 "),e("label",ts,[d(e("input",{type:"checkbox","onUpdate:modelValue":s[14]||(s[14]=o=>t.default_logging_response_body=o)},null,512),[[h,t.default_logging_response_body]]),r(" Log response body ")])])])):_("",!0)])]),e("div",os,[e("div",is,[i.$route.params.id?(l(),n("button",{key:0,class:"button is-link",type:"submit",onClick:s[15]||(s[15]=o=>u.editRedirector())},ds)):(l(),n("button",{key:1,class:"button is-link",type:"submit",onClick:s[16]||(s[16]=o=>u.addRedirector())},_s))]),e("div",cs,[T(m,{class:"button is-link is-light",to:"/redirectors"},{default:g(()=>[hs,us]),_:1})])])])])):_("",!0)]),_:1})}const bs=C(P,[["render",ps]]);export{bs as default};

import{D as b}from"./datetime.ba57e231.js";import{e as v,f as y,o as t,g as k,h as g,T as w,c as n,a as s,n as a,b as c,p as d,j as l,t as o,F as u,d as h,i as q,k as R}from"./index.236180ad.js";import{_ as x}from"./_plugin-vue_export-helper.cdc0426e.js";const D={computed:{DateTime(){return b}},data(){return{selected_tab:"overview",isLoading:!0,log:""}},methods:{getLog(){this.$route.params.id>0&&fetch("/api/requests/"+this.$route.params.id).then(r=>r.json()).then(r=>{this.log=r,this.isLoading=!1})}},created(){this.getLog()}},L={key:0},C={class:"box"},T=s("h1",{class:"title"},"Request Details",-1),B={class:"tabs"},N=s("a",null,"Overview",-1),S=[N],A=s("a",null,"Request",-1),V=[A],F=s("a",null,"Response",-1),H=[F],O={class:"content"},P=s("strong",null,"When: ",-1),I=s("strong",null,"Allowed: ",-1),M={class:"icon"},j={key:0,class:"fas fa-circle-check has-text-success","aria-hidden":"true"},z={key:1,class:"fas fa-circle-xmark has-text-danger","aria-hidden":"true"},U={key:0,class:"has-text-success"},E={key:1,class:"has-text-danger"},W=s("br",null,null,-1),Y=s("strong",null,"Action: ",-1),G={key:2},J=s("i",{class:"fas fa-x","aria-hidden":"true"},null,-1),K={key:3},Q=s("i",{class:"fas fa-bomb","aria-hidden":"true"},null,-1),X={key:4},Z=s("i",{class:"fas fa-file","aria-hidden":"true"},null,-1),$={key:5},ss={key:6},es=s("br",null,null,-1),os=s("strong",null,"Status Code: ",-1),ts=s("br",null,null,-1),ns=s("strong",null,"User Agent: ",-1),ls=s("br",null,null,-1),is=s("strong",null,"IP Address: ",-1),rs=s("br",null,null,-1),_s=s("strong",null,"ASN Organization ",-1),cs=s("br",null,null,-1),us=s("strong",null,"Country: ",-1),as=s("br",null,null,-1),ds=s("strong",null,"Hostname: ",-1),hs=s("br",null,null,-1),ps=s("strong",null,"Path: ",-1),gs=s("br",null,null,-1),fs=s("strong",null,"Method: ",-1),ms=s("strong",null,"Request Handler Log:",-1),bs=s("br",null,null,-1),vs=s("strong",null,"Request Headers",-1),ys=["href"],ks=s("strong",null,"Response Headers",-1),ws=["href"],qs={class:"field is-grouped"},Rs={class:"control"},xs=["href"],Ds=s("span",{class:"icon"},[s("i",{class:"fas fa-download"})],-1),Ls=s("span",null,"Download Request",-1),Cs=[Ds,Ls],Ts=["href"],Bs=s("span",{class:"icon"},[s("i",{class:"fas fa-download"})],-1),Ns=s("span",null,"Download Response",-1),Ss=[Bs,Ns],As=s("span",{class:"icon"},[s("i",{class:"fas fa-arrow-left"})],-1),Vs=s("span",null,"Back To Logs",-1);function Fs(r,i,Hs,Os,e,p){const f=v("RouterLink"),m=y("tooltip");return t(),k(w,null,{default:g(()=>[e.isLoading===!1?(t(),n("div",L,[s("div",C,[T,s("div",B,[s("ul",null,[s("li",{class:a({"is-active":e.selected_tab==="overview"}),onClick:i[0]||(i[0]=_=>e.selected_tab="overview")},S,2),s("li",{class:a({"is-active":e.selected_tab==="request"}),onClick:i[1]||(i[1]=_=>e.selected_tab="request")},V,2),s("li",{class:a({"is-active":e.selected_tab==="response"}),onClick:i[2]||(i[2]=_=>e.selected_tab="response")},H,2)])]),s("div",O,[c(s("div",null,[s("p",null,[P,c((t(),n("span",null,[l(o(p.DateTime.fromISO(e.log.datetime).toFormat("yyyy-MM-dd hh:mm:ss"))+" ("+o(p.DateTime.fromISO(e.log.datetime).toRelative())+")",1)])),[[m,e.log.datetime,void 0,{top:!0}]])]),s("p",null,[I,s("span",M,[e.log.allowed===!0?(t(),n("i",j)):(t(),n("i",z))]),e.log.allowed===!0?(t(),n("span",U,"Yes")):(t(),n("span",E,"No")),W,Y,e.log.action==="404"?(t(),n("span",G,[J,l(" 404")])):e.log.action==="payload"?(t(),n("span",K,[Q,l(" Payload"),e.log.payload_name?(t(),n(u,{key:0},[l(" ("+o(e.log.payload_name)+")",1)],64)):h("",!0)])):e.log.action==="file"?(t(),n("span",X,[Z,l(" File"),e.log.file_name?(t(),n(u,{key:0},[l(" ("+o(e.log.file_name)+")",1)],64)):h("",!0)])):e.log.action==="passthrough"?(t(),n("span",$,"Passthrough")):(t(),n("span",ss,"Unknown")),es,os,s("span",null,o(e.log.response_status),1),ts]),s("p",null,[ns,s("span",null,o(e.log.request_user_agent),1),ls,is,s("span",null,o(e.log.request_ip),1),rs,_s,s("span",null,o(e.log.request_asn_org_name),1),cs,us,s("span",null,o(e.log.request_country_code),1),as]),s("p",null,[ds,s("span",null,o(e.log.redirector_hostname),1),hs,ps,s("span",null,o(e.log.redirector_path),1),gs,fs,s("span",null,o(e.log.request_method),1)]),s("p",null,[ms,s("pre",null,[(t(!0),n(u,null,q(e.log.messages,_=>(t(),n(u,null,[l(o(_.message),1),bs],64))),256))])])],512),[[d,e.selected_tab==="overview"]]),c(s("div",null,[vs,s("pre",null,o(e.log.request_headers),1),s("strong",null,[l("Request Body (first 2048 bytes) ("),s("a",{href:"/api/requests/"+e.log.id+"/request/download"},"download raw",8,ys),l(")")]),s("pre",null,o(e.log.request_body),1)],512),[[d,e.selected_tab==="request"]]),c(s("div",null,[ks,s("pre",null,o(e.log.response_headers),1),s("strong",null,[l("Response Body (first 2048 bytes) ("),s("a",{href:"/api/requests/"+e.log.id+"/response/download"},"download raw",8,ws),l(")")]),s("pre",null,o(e.log.response_body),1)],512),[[d,e.selected_tab==="response"]])]),s("div",qs,[s("div",Rs,[s("a",{class:"button is-link",href:"/api/requests/"+e.log.id+"/request/download"},Cs,8,xs),l(" \xA0 "),s("a",{class:"button is-link",href:"/api/requests/"+e.log.id+"/response/download"},Ss,8,Ts),l(" \xA0 "),R(f,{class:"button is-link",type:"submit",to:"/logs"},{default:g(()=>[As,Vs]),_:1})])])])])):h("",!0)]),_:1})}const js=x(D,[["render",Fs]]);export{js as default};

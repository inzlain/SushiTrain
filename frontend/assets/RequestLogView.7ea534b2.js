import{D as v}from"./datetime.ba57e231.js";import{e as b,f as y,o,g as k,h as g,T as w,c as n,a as s,n as u,b as c,p as d,j as l,t,F as a,d as h,i as q,k as R}from"./index.eecb294c.js";import{_ as x}from"./_plugin-vue_export-helper.cdc0426e.js";const D={computed:{DateTime(){return v}},data(){return{selected_tab:"overview",isLoading:!0,log:""}},methods:{getLog(){this.$route.params.id>0&&fetch("/api/requests/"+this.$route.params.id).then(r=>r.json()).then(r=>{this.log=r,this.isLoading=!1})}},created(){this.getLog()}},L={key:0},C={class:"box"},T=s("h1",{class:"title"},"Request Details",-1),B={class:"tabs"},N=s("a",null,"Overview",-1),S=[N],A=s("a",null,"Request",-1),V=[A],F=s("a",null,"Response",-1),H=[F],O={class:"content"},P=s("strong",null,"When: ",-1),I=s("strong",null,"Allowed: ",-1),j={class:"icon"},z={key:0,class:"fas fa-circle-check has-text-success","aria-hidden":"true"},M={key:1,class:"fas fa-circle-xmark has-text-danger","aria-hidden":"true"},U={key:0,class:"has-text-success"},E={key:1,class:"has-text-danger"},W=s("br",null,null,-1),Y=s("strong",null,"Action: ",-1),G={key:2},J=s("i",{class:"fas fa-x","aria-hidden":"true"},null,-1),K={key:3},Q=s("i",{class:"fas fa-bomb","aria-hidden":"true"},null,-1),X={key:4},Z=s("i",{class:"fas fa-file","aria-hidden":"true"},null,-1),$={key:5},ss={key:6},es=s("br",null,null,-1),os=s("strong",null,"Status Code: ",-1),ts=s("br",null,null,-1),ns=s("strong",null,"User Agent: ",-1),ls=s("br",null,null,-1),is=s("strong",null,"IP Address: ",-1),rs=s("br",null,null,-1),_s=s("strong",null,"ASN Organization ",-1),cs=s("br",null,null,-1),as=s("strong",null,"Country: ",-1),us=s("br",null,null,-1),ds=s("strong",null,"Hostname: ",-1),hs=s("br",null,null,-1),ps=s("strong",null,"Path: ",-1),gs=s("strong",null,"Request Handler Log:",-1),fs=s("br",null,null,-1),ms=s("strong",null,"Request Headers",-1),vs=["href"],bs=s("strong",null,"Response Headers",-1),ys=["href"],ks={class:"field is-grouped"},ws={class:"control"},qs=["href"],Rs=s("span",{class:"icon"},[s("i",{class:"fas fa-download"})],-1),xs=s("span",null,"Download Request",-1),Ds=[Rs,xs],Ls=["href"],Cs=s("span",{class:"icon"},[s("i",{class:"fas fa-download"})],-1),Ts=s("span",null,"Download Response",-1),Bs=[Cs,Ts],Ns=s("span",{class:"icon"},[s("i",{class:"fas fa-arrow-left"})],-1),Ss=s("span",null,"Back To Logs",-1);function As(r,i,Vs,Fs,e,p){const f=b("RouterLink"),m=y("tooltip");return o(),k(w,null,{default:g(()=>[e.isLoading===!1?(o(),n("div",L,[s("div",C,[T,s("div",B,[s("ul",null,[s("li",{class:u({"is-active":e.selected_tab==="overview"}),onClick:i[0]||(i[0]=_=>e.selected_tab="overview")},S,2),s("li",{class:u({"is-active":e.selected_tab==="request"}),onClick:i[1]||(i[1]=_=>e.selected_tab="request")},V,2),s("li",{class:u({"is-active":e.selected_tab==="response"}),onClick:i[2]||(i[2]=_=>e.selected_tab="response")},H,2)])]),s("div",O,[c(s("div",null,[s("p",null,[P,c((o(),n("span",null,[l(t(p.DateTime.fromISO(e.log.datetime).toFormat("yyyy-MM-dd hh:mm:ss"))+" ("+t(p.DateTime.fromISO(e.log.datetime).toRelative())+")",1)])),[[m,e.log.datetime,void 0,{top:!0}]])]),s("p",null,[I,s("span",j,[e.log.allowed===!0?(o(),n("i",z)):(o(),n("i",M))]),e.log.allowed===!0?(o(),n("span",U,"Yes")):(o(),n("span",E,"No")),W,Y,e.log.action==="404"?(o(),n("span",G,[J,l(" 404")])):e.log.action==="payload"?(o(),n("span",K,[Q,l(" Payload"),e.log.payload_name?(o(),n(a,{key:0},[l(" ("+t(e.log.payload_name)+")",1)],64)):h("",!0)])):e.log.action==="file"?(o(),n("span",X,[Z,l(" File"),e.log.file_name?(o(),n(a,{key:0},[l(" ("+t(e.log.file_name)+")",1)],64)):h("",!0)])):e.log.action==="passthrough"?(o(),n("span",$,"Passthrough")):(o(),n("span",ss,"Unknown")),es,os,s("span",null,t(e.log.response_status),1),ts]),s("p",null,[ns,s("span",null,t(e.log.request_user_agent),1),ls,is,s("span",null,t(e.log.request_ip),1),rs,_s,s("span",null,t(e.log.request_asn_org_name),1),cs,as,s("span",null,t(e.log.request_country_code),1),us]),s("p",null,[ds,s("span",null,t(e.log.redirector_hostname),1),hs,ps,s("span",null,t(e.log.redirector_path),1)]),s("p",null,[gs,s("pre",null,[(o(!0),n(a,null,q(e.log.messages,_=>(o(),n(a,null,[l(t(_.message),1),fs],64))),256))])])],512),[[d,e.selected_tab==="overview"]]),c(s("div",null,[ms,s("pre",null,t(e.log.request_headers),1),s("strong",null,[l("Request Body (first 2048 bytes) ("),s("a",{href:"/api/requests/"+e.log.id+"/request/download"},"download raw",8,vs),l(")")]),s("pre",null,t(e.log.request_body),1)],512),[[d,e.selected_tab==="request"]]),c(s("div",null,[bs,s("pre",null,t(e.log.response_headers),1),s("strong",null,[l("Response Body (first 2048 bytes) ("),s("a",{href:"/api/requests/"+e.log.id+"/response/download"},"download raw",8,ys),l(")")]),s("pre",null,t(e.log.response_body),1)],512),[[d,e.selected_tab==="response"]])]),s("div",ks,[s("div",ws,[s("a",{class:"button is-link",href:"/api/requests/"+e.log.id+"/request/download"},Ds,8,qs),l(" \xA0 "),s("a",{class:"button is-link",href:"/api/requests/"+e.log.id+"/response/download"},Bs,8,Ls),l(" \xA0 "),R(f,{class:"button is-link",type:"submit",to:"/logs"},{default:g(()=>[Ns,Ss]),_:1})])])])])):h("",!0)]),_:1})}const Is=x(D,[["render",As]]);export{Is as default};
